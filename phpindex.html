<!DOCTYPE html>
<html>
<head>
  <script src="jquery.js"></script>
  <meta charset="utf-8">

</head>
<body>
  <h2>Add job</h2>
  <form id="addjobform">
    <input type="file" name="image" id="image">
    <input type="text" name="description"placeholder="Tell about your dog"  id="description">
    <input type="text" name="payment" placeholder="Payment"  id="payment">
    <input type="email"  name="email" placeholder="Email"  id="email">
    <input type="text" name="location" placeholder="Location (1-12)"  id="location">
    <input type="submit" value="submit">
  </form>

  <h2>Get Job</h2>
  <form id="getjobform">
    <input type="text" name="area" placeholder="1-12" id="area">
    <input type="submit" value="Submit">
  </form>

  <p id="outputP"></p>

<script>

/* $('#addjob').submit(function(e) {

//  var formData = new FormData($(this)[0]);


  $.ajax({
    url: "backend.php",
    type: "POST",
    data: formData,
    async: true,
    success: function (msg) {
     console.log(msg);
    },
    cache: false,
    contentType: false,
    processData: false
  });s
});
function addjob()
{
  $.post('backend.php', $('#addjobform').serialize())
}*/
// this is the id of the form
$("#addjobform").submit(function(e) {

    var url = "addjob.php"; // the script where you handle the form input.

    $.ajax({
           type: "POST",
           url: url,
           data: new FormData( this ),
           processData: false,
           contentType: false,
           success: function(data0)
           {
               alert(data0); // show response from the php script.
           }
         });

    e.preventDefault(); // avoid to execute the actual submit of the form.
});

$("#getjobform").submit(function(k) {

    var url = "listjobs.php"; // the script where you handle the form input.

    $.ajax({
           type: "POST",
           url: url,
           data: new FormData( this ),
           processData: false,
           contentType: false,
           success: function(data1)
           {
               //alert(data1); // show response from the php script.
               var y = 0;
               var output = JSON.parse(data1);
               console.log(output);
               //$("#outputP"). // "Clear"-function?
               while(y < output.length)
               {
                    if (output[y].image == "upload/") {
                      output[y].image = "uk_dog.png";
                    }

                    $("#outputP").append("<img style='height: 75px; width: 75px' src='http://towall.tk/" + output[y].image + "'> <br/> <p><strong>Basic Information: </strong>" + output[y].description + "</p> <br /> <p><strong>Location: </strong>" + output[y].location + "</p> <br /> <p><strong>Payment: </strong>" + output[y].payment + "<br/> <button id='btn' type='button' onclick='takeJob(" + y + ", " + output[y].id + ")'>Take Job</button> <div id='cForm" + y + "'></div>");
                    
                    var Payment = isNaN(output[y].payment); // Should check if € is needed at the end of variable payment
                    if (Payment = false) {
                      $("#outputP").append("€");
                    }
                    y++;

               }
          }
    });

    k.preventDefault(); // avoid to execute the actual submit of the form.
});

$("#takejobform").submit(function(x) {

    var url = "takejob.php"; // the script where you handle the form input.

    $.ajax({
           type: "POST",
           url: url,
           data: new FormData( this ),
           processData: false,
           contentType: false,
           success: function(data2)
           {
               alert(data2); // show response from the php script.
           }
         });

    x.preventDefault(); // avoid to execute the actual submit of the form.
});

function takeJob(formid, unid) {
  $("#cForm" + formid + "").append("<form id='takejobform'><input type='text' placeholder='Message' id='message' name='message'><input type='text' placeholder='Your email' id='useremail' name='useremail'><input id='uid' name='uid' type='hidden' value='" + unid + "'><input type='submit' value='Send'></form>");
}

</script>
</body>

</html>
